function [xd_horizon, u0,i] = shift(u,N_horizon,i)
xd=[-9.57943925233645,26.9859813084112;-8.64485981308412,27.2196261682243;-7.00934579439252,27.9205607476636;-4.90654205607477,29.5560747663552;-1.16822429906542,31.1915887850467;1.63551401869159,33.0607476635514;4.43925233644860,34.6962616822430;7.47663551401869,36.3317757009346;10.2803738317757,37.5000000000000;13.0841121495327,39.6028037383178;16.3551401869159,41.2383177570094;18.9252336448598,43.1074766355140;20.5607476635514,44.2757009345795;22.8971962616822,45.6775700934580;25,47.0794392523365;26.4018691588785,47.7803738317757;28.0373831775701,48.9485981308411;28.9719626168224,49.4158878504673;30.3738317757009,49.8831775700935;31.0747663551402,50.3504672897196;32.0093457943925,51.0514018691589;33.6448598130841,51.7523364485981;34.5794392523365,52.2196261682243;36.2149532710280,52.9205607476636;38.0841121495327,53.8551401869159;39.2523364485981,54.3224299065421;41.1214953271028,55.0233644859813;41.5887850467290,55.2570093457944;42.0560747663551,55.4906542056075;42.2897196261682,55.4906542056075;42.5233644859813,55.4906542056075;42.7570093457944,55.4906542056075];

if size(xd(i:end,:),1)>=N_horizon
    xd_horizon = xd(i:i+N_horizon-1,:);
else
    n_end = N_horizon - size(xd(i:end,:),1);
    xd_horizon = [xd(i:end,:); ones(n_end,1)*xd(end,:)];      
end
u0 = [u(:,2:size(u,2)) u(:,size(u,2))];
i = i+1;
end